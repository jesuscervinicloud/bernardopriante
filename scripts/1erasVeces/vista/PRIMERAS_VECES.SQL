 select c.CLIENTE_ID as "1v1_CLIENTE_ID", c.NOMBRE as "1v2_NOMBRE",  tc.NOMBRE AS "1v3_COMO_SUPO", CLIENTE_MATRIZ.R_NOMBRE AS "1v4_NOMBRE_DOCTOR"
,CITA_PRIMERA_VEZ.R_PRIMERA_VEZ AS "1v5_TIENE_CITA_1A_VEZ", CITA_PRIMERA_VEZ.R_FECHA_INICIAL as "1v6_FECHA_CITA_1A_VEZ"
,CITA_PRIMERA_VEZ.R_USUARIO_RESPONSABLE AS "1v7_RESPONSABLE_CITA_1A_VEZ", c.FECHA_HORA_CREACION as "1v8_FECHA_ALTA"
,('M'|| extract(year from c.FECHA_HORA_CREACION) || substring(100+extract(month from c.FECHA_HORA_CREACION) from 2 for 2)) as "1v9_AÃ‘OMES_ALTA"
, FECHA_PRIMERA_COTIZACION.FECHA AS "1v10_FECHA_1ER_COTIZACION", FECHA_PRIMERA_COTIZACION.FOLIO AS "1v1_FOLIO_1ER_COTIZACION", FECHA_PRIMERA_COTIZACION.VENDEDOR AS "1v12_VENDEDOR_1ER_COTIZACION", FECHA_PRIMERA_COTIZACION.TIENE_COTIZACION  as "1v13_TIENE_COTIZACION" 
,(case
            when CITA_PRIM
CREATE VIEW PRIMERAS_VECES ("1v1","1v2","1v3","1v4","1v5","1v6","1v7","1v8","1v9","1v10","1v11","1v12","1v13","1v14","1v14_1") AS   select c.CLIENTE_ID as "1v1", c.NOMBRE as "1v2",  tc.NOMBRE AS "1v3", CLIENTE_MATRIZ.R_NOMBRE AS "1v4"
,CITA_PRIMERA_VEZ.R_PRIMERA_VEZ AS "1v5", CITA_PRIMERA_VEZ.R_FECHA_INICIAL as "1v6"
,CITA_PRIMERA_VEZ.R_USUARIO_RESPONSABLE AS "1v7", c.FECHA_HORA_CREACION as "1v8"
,('M'|| extract(year from c.FECHA_HORA_CREACION) || substring(100+extract(month from c.FECHA_HORA_CREACION) from 2 for 2)) as "1v9"
, FECHA_PRIMERA_COTIZACION.FECHA AS "1v10", FECHA_PRIMERA_COTIZACION.FOLIO AS "1v11", FECHA_PRIMERA_COTIZACION.VENDEDOR AS "1v12", FECHA_PRIMERA_COTIZACION.TIENE_COTIZACION  as "1v13" 
,(case
            when CITA_PRIMERA_VEZ.R_PRIMERA_VEZ = 1 or FECHA_PRIMERA_COTIZACION.TIENE_COTIZACION =  1 then 1
            else null
          end) as "1v14"
,(case
            when FECHA_PRIMERA_COTIZACION.VENDEDOR is null then (case
            	when CITA_PRIMERA_VEZ.R_USUARIO_RESPONSABLE is null then null
            	else 'BUSCAR'
          		end)
            else FECHA_PRIMERA_COTIZACION.VENDEDOR
          end) as "1v14_1"
from CLIENTES c
left join CITA_PRIMERA_VEZ(c.CLIENTE_ID) on 1=1 inner join TIPOS_CLIENTES tc on tc.TIPO_CLIENTE_ID = c.TIPO_CLIENTE_ID
left join CLIENTE_MATRIZ(c.CLIENTE_ID) on 1=1 left join FECHA_PRIMERA_COTIZACION(c.CLIENTE_ID) on 1=1

;

ERA_VEZ.R_PRIMERA_VEZ = 1 or FECHA_PRIMERA_COTIZACION.TIENE_COTIZACION =  1 then 1
            else null
          end) as "1v14_TIENE_CITA_1a_VEZ_O_TIENE_COTIZACION"
,(case
            when FECHA_PRIMERA_COTIZACION.VENDEDOR is null then (case
            	when CITA_PRIMERA_VEZ.R_USUARIO_RESPONSABLE is null then null
            	else 'BUSCAR'
          		end)
            else FECHA_PRIMERA_COTIZACION.VENDEDOR
          end) as "1v14_1_VENDEDOR_COTIZACION_O_CITA_1A_VEZ"
from CLIENTES c
left join CITA_PRIMERA_VEZ(c.CLIENTE_ID) on 1=1 inner join TIPOS_CLIENTES tc on tc.TIPO_CLIENTE_ID = c.TIPO_CLIENTE_ID
left join CLIENTE_MATRIZ(c.CLIENTE_ID) on 1=1 left join FECHA_PRIMERA_COTIZACION(c.CLIENTE_ID) on 1=1
where c.CLIENTE_ID in (261499, 260716, 25876,10753,10757,10761,10765,261805,10769,10773)
;

SELECT FIRST 10 * FROM PRIMERAS_VECES;
