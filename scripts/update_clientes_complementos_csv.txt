CREATE OR ALTER PROCEDURE INSERT_CLIENTES_COMPLEMENTOS RETURNS (V_CLIENTE_ID INTEGER, V_GIRO_ID INTEGER, V_CALIFICACION_ID VARCHAR(25), V_ORIGEN_ID VARCHAR(25), V_CON_IMPUESTO VARCHAR(25), V_NOMBRE_COMERCIAL VARCHAR(50), V_RESPETAR_VENDEDOR VARCHAR(25), V_FECHA_ULT_ACCION VARCHAR(25), V_ULT_ACCION_TAREA_ID VARCHAR(25), V_CLIENTE_MATRIZ_ID VARCHAR(25), V_FECHA_CONVERSION VARCHAR(25), V_TIPO_ORGANIZACION_ID INTEGER, V_HABILITAR_POLITICA_PREC_ART VARCHAR(25), V_LIGADO_ORGANIZACION VARCHAR(25), V_CONTACTO_CONTACTO_ULT_ID VARCHAR(25), V_VENDEDOR_ID INTEGER)
AS DECLARE VARIABLE lcComando VARCHAR(3500);

BEGIN
      lcComando = 'SELECT CLIENTE_ID,GIRO_ID,CALIFICACION_ID,ORIGEN_ID ,CON_IMPUESTO,NOMBRE_COMERCIAL,RESPETAR_VENDEDOR,FECHA_ULT_ACCION,ULT_ACCION_TAREA_ID,CLIENTE_MATRIZ_ID ,FECHA_CONVERSION,TIPO_ORGANIZACION_ID ,HABILITAR_POLITICA_PREC_ART,LIGADO_ORGANIZACION,CONTACTO_CONTACTO_ULT_ID,VENDEDOR_ID from CLIENTES_COMPLEMENTOS_CSV order by CLIENTE_ID';
FOR EXECUTE STATEMENT lcComando
      ON EXTERNAL DATA SOURCE 'C:\Users\jesus\Documents\bernardo\db\ZeusAudimed.fdb'
AS USER 'SYSDBA'
   PASSWORD 'masterkey'
   INTO
      :V_CLIENTE_ID,:V_GIRO_ID,:V_CALIFICACION_ID,:V_ORIGEN_ID ,:V_CON_IMPUESTO,:V_NOMBRE_COMERCIAL,:V_RESPETAR_VENDEDOR,:V_FECHA_ULT_ACCION,
      :V_ULT_ACCION_TAREA_ID,:V_CLIENTE_MATRIZ_ID ,:V_FECHA_CONVERSION,:V_TIPO_ORGANIZACION_ID ,:V_HABILITAR_POLITICA_PREC_ART,:V_LIGADO_ORGANIZACION,
      :V_CONTACTO_CONTACTO_ULT_ID,:V_VENDEDOR_ID
      
   DO BEGIN
   IF (EXISTS(SELECT * FROM CLIENTES_COMPLEMENTOS C WHERE 
C.CLIENTE_ID = :V_CLIENTE_ID))
 THEN 
       UPDATE CLIENTES_COMPLEMENTOS SET CLIENTE_MATRIZ_ID = :V_CLIENTE_MATRIZ_ID, LIGADO_A_ORGANIZACION =  :V_LIGADO_ORGANIZACION WHERE CLIENTE_ID = :V_CLIENTE_ID;
      ELSE
      BEGIN
         INSERT INTO CLIENTES_COMPLEMENTOS (CLIENTE_ID,GIRO_ID ,CALIFICACION_ID ,ORIGEN_ID ,CON_IMPUESTO,NOMBRE_COMERCIAL ,RESPETAR_VENDEDOR ,FECHA_ULT_ACCION ,
	ULT_ACCION_TAREA_ID,CLIENTE_MATRIZ_ID ,	FECHA_CONVERSION ,	TIPO_ORGANIZACION_ID ,	HABILITAR_POLITICA_PRECIOS_ART ,	LIGADO_A_ORGANIZACION ,
	CONTACTO_CONTACTO_ULT_ID ,	VENDEDOR_ID  ) values (
	:V_CLIENTE_ID,:V_GIRO_ID,null,null ,:V_CON_IMPUESTO,:V_NOMBRE_COMERCIAL,:V_RESPETAR_VENDEDOR,null,
      null,:V_CLIENTE_MATRIZ_ID ,null,:V_TIPO_ORGANIZACION_ID ,:V_HABILITAR_POLITICA_PREC_ART,:V_LIGADO_ORGANIZACION,
      null,:V_VENDEDOR_ID	);
      END 
      
      SUSPEND;
   END
 END

